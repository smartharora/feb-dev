<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>For You</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;500;600&display=swap" rel="stylesheet">

    <style>
        /* ===================================
           GLOBAL RESET & BASE STYLES
        =================================== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        :root {
            /* PERSONALIZE: Adjust color palette here */
            --color-primary: #FFB6C1;
            --color-secondary: #FFC8DD;
            --color-accent: #FF85A2;
            --color-bg-light: #FFF5F7;
            --color-bg-cream: #FFFBF5;
            --color-text-dark: #4A4A4A;
            --color-text-light: #7A7A7A;
            --color-white: #FFFFFF;

            --font-primary: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            --font-handwritten: 'Dancing Script', cursive;
            --transition-smooth: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            --shadow-soft: 0 4px 20px rgba(255, 133, 162, 0.15);
        }

        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--color-bg-light) 0%, var(--color-bg-cream) 100%);
            color: var(--color-text-dark);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
            position: relative;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><text y="20" font-size="20">‚ù§Ô∏è</text></svg>') 12 12, auto;
        }

        /* Heart cursor for clickable elements */
        button, .reason-card, .heart-unlock, [onclick] {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><text y="24" font-size="24">üíï</text></svg>') 14 14, pointer !important;
        }

        /* ===================================
           VIGNETTE EFFECT
        =================================== */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
            box-shadow: inset 0 0 200px rgba(0, 0, 0, 0.15);
        }

        /* ===================================
           LOADING ANIMATION
        =================================== */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: linear-gradient(135deg, #FFE5EC 0%, #FFF5F7 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.8s ease, visibility 0.8s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-heart {
            font-size: 4rem;
            animation: heartPulse 1.5s ease-in-out infinite;
            margin-bottom: 1.5rem;
        }

        @keyframes heartPulse {
            0%, 100% { transform: scale(1); opacity: 0.8; }
            50% { transform: scale(1.2); opacity: 1; }
        }

        .loading-text {
            font-size: 1.25rem;
            color: var(--color-text-light);
            font-family: var(--font-handwritten);
            animation: fadeInOut 2s ease-in-out infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* ===================================
           FLOATING HEARTS BACKGROUND
        =================================== */
        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 5;
            overflow: hidden;
        }

        .heart {
            position: absolute;
            bottom: -50px;
            font-size: 48px;
            color: var(--color-primary);
            opacity: 0;
            animation: floatUp 15s infinite ease-in;
        }

        .heart:nth-child(1) { left: 10%; animation-delay: 0s; font-size: 40px; }
        .heart:nth-child(2) { left: 20%; animation-delay: 3s; font-size: 56px; }
        .heart:nth-child(3) { left: 30%; animation-delay: 1s; font-size: 44px; }
        .heart:nth-child(4) { left: 40%; animation-delay: 5s; font-size: 52px; }
        .heart:nth-child(5) { left: 50%; animation-delay: 2s; font-size: 60px; }
        .heart:nth-child(6) { left: 60%; animation-delay: 4s; font-size: 42px; }
        .heart:nth-child(7) { left: 70%; animation-delay: 6s; font-size: 54px; }
        .heart:nth-child(8) { left: 80%; animation-delay: 1.5s; font-size: 46px; }
        .heart:nth-child(9) { left: 90%; animation-delay: 3.5s; font-size: 50px; }

        @keyframes floatUp {
            0% {
                bottom: -50px;
                opacity: 0;
                transform: translateX(0) rotate(0deg);
            }
            10% {
                opacity: 0.5;
            }
            50% {
                opacity: 0.4;
            }
            90% {
                opacity: 0.1;
            }
            100% {
                bottom: 110vh;
                opacity: 0;
                transform: translateX(100px) rotate(360deg);
            }
        }

        /* ===================================
           ANIMATED GRADIENTS
        =================================== */
        @keyframes gradientShift {
            0%, 100% {
                background-position: 0% 50%;
            }
            50% {
                background-position: 100% 50%;
            }
        }

        .animated-gradient {
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
        }

        /* ===================================
           CHAPTER CONTAINER & TRANSITIONS
        =================================== */
        .chapter {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 24px;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-smooth);
            transform: translateY(20px);
            z-index: 10;
        }

        .chapter.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .chapter.exiting {
            opacity: 0;
            transform: scale(1.05);
            filter: blur(20px);
        }

        /* ===================================
           CHAPTER 0: OPENING
        =================================== */
        #chapter-0 {
            background: linear-gradient(135deg, #FFE5EC 0%, #FFF5F7 50%, #FFE5EC 100%);
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
        }

        .opening-content {
            text-align: center;
            max-width: 400px;
        }

        .opening-content h1 {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: -0.02em;
            color: var(--color-text-dark);
            margin-bottom: 1.5rem;
            animation: fadeInUp 1s ease forwards;
            animation-delay: 0.5s;
            opacity: 0;
        }

        .opening-content p {
            font-size: 1.125rem;
            color: var(--color-text-light);
            margin-bottom: 3rem;
            animation: fadeInUp 1s ease forwards;
            animation-delay: 1s;
            opacity: 0;
        }

        .btn-begin {
            padding: 16px 48px;
            font-size: 1rem;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            box-shadow: var(--shadow-soft);
            animation: fadeInUp 1s ease forwards;
            animation-delay: 1.5s;
            opacity: 0;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .btn-begin:active {
            transform: scale(0.95);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
            from {
                opacity: 0;
                transform: translateY(20px);
            }
        }

        /* ===================================
           CHAPTER 1: UNLOCK (Quiz)
        =================================== */
        #chapter-1 {
            background: linear-gradient(135deg, var(--color-bg-cream) 0%, var(--color-bg-light) 50%, var(--color-bg-cream) 100%);
            background-size: 200% 200%;
            animation: gradientShift 10s ease infinite;
        }

        .quiz-content {
            text-align: center;
            max-width: 420px;
            width: 100%;
        }

        .quiz-content h2 {
            font-size: 1.75rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            color: var(--color-text-dark);
        }

        .quiz-progress {
            font-size: 0.875rem;
            color: var(--color-text-light);
            margin-bottom: 2rem;
        }

        .quiz-card {
            background: white;
            border-radius: 20px;
            padding: 32px 28px;
            box-shadow: var(--shadow-soft);
            min-height: 300px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .quiz-question {
            font-size: 1.125rem;
            color: var(--color-text-dark);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .quiz-option {
            padding: 16px 24px;
            border: 2px solid var(--color-primary);
            background: white;
            color: var(--color-text-dark);
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 1rem;
            font-weight: 500;
        }

        .quiz-option:hover {
            background: var(--color-bg-light);
        }

        .quiz-option:active {
            transform: scale(0.97);
        }

        .quiz-option.correct {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            border-color: var(--color-accent);
            animation: correctPulse 0.5s ease;
        }

        .quiz-option.wrong {
            background: #FFE5E5;
            border-color: #FF6B6B;
            animation: shake 0.5s ease;
        }

        @keyframes correctPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        /* Wrong Answer Screen */
        .wrong-screen {
            display: none;
            text-align: center;
            max-width: 400px;
        }

        .wrong-screen.active {
            display: block;
        }

        .wrong-screen h2 {
            font-size: 2rem;
            font-weight: 300;
            color: var(--color-text-dark);
            margin-bottom: 1rem;
        }

        .wrong-screen p {
            font-size: 1.125rem;
            color: var(--color-text-light);
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .broken-heart {
            font-size: 5rem;
            margin-bottom: 1.5rem;
            animation: fadeIn 1s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        /* ===================================
           CHAPTER 2: TEXT INPUT QUESTION
        =================================== */
        #chapter-2 {
            background: linear-gradient(135deg, var(--color-bg-light) 0%, var(--color-bg-cream) 50%, var(--color-bg-light) 100%);
            background-size: 200% 200%;
            animation: gradientShift 10s ease infinite;
        }

        .text-question-content {
            text-align: center;
            max-width: 420px;
            width: 100%;
        }

        .text-question-content h2 {
            font-size: 1.75rem;
            font-weight: 300;
            margin-bottom: 0.5rem;
            color: var(--color-text-dark);
        }

        .text-question-content p {
            font-size: 1rem;
            color: var(--color-text-light);
            margin-bottom: 2rem;
        }

        .text-input-card {
            background: white;
            border-radius: 20px;
            padding: 32px 28px;
            box-shadow: var(--shadow-soft);
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .text-question {
            font-size: 1.25rem;
            color: var(--color-text-dark);
            margin-bottom: 2rem;
            line-height: 1.6;
            font-weight: 400;
        }

        .text-input-wrapper {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .text-answer-input {
            width: 100%;
            padding: 16px 20px;
            font-size: 1rem;
            border: 2px solid var(--color-primary);
            border-radius: 50px;
            background: white;
            color: var(--color-text-dark);
            transition: var(--transition-smooth);
            font-family: var(--font-primary);
            text-align: center;
        }

        .text-answer-input:focus {
            outline: none;
            border-color: var(--color-accent);
            box-shadow: 0 0 0 4px rgba(255, 133, 162, 0.1);
        }

        .text-answer-input::placeholder {
            color: var(--color-text-light);
            opacity: 0.6;
        }

        .text-submit-btn {
            padding: 14px 40px;
            border: none;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 1rem;
            font-weight: 500;
            box-shadow: var(--shadow-soft);
            width: 100%;
        }

        .text-submit-btn:active {
            transform: scale(0.97);
        }

        .text-submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .text-feedback {
            margin-top: 1rem;
            font-size: 0.9375rem;
            min-height: 24px;
            transition: var(--transition-smooth);
        }

        .text-feedback.correct {
            color: var(--color-accent);
            animation: fadeInUp 0.5s ease;
        }

        .text-feedback.wrong {
            color: #FF6B6B;
            animation: shake 0.5s ease;
        }

        /* ===================================
           CHAPTER 3: TIMELINE
        =================================== */
        #chapter-3 {
            justify-content: flex-start;
            padding-top: 60px;
        }

        .timeline-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .timeline-header h2 {
            font-size: 1.75rem;
            font-weight: 300;
            color: var(--color-text-dark);
            margin-bottom: 0.5rem;
        }

        .timeline-progress {
            font-size: 0.875rem;
            color: var(--color-text-light);
        }

        .timeline-card {
            background: white;
            border-radius: 20px;
            padding: 32px 28px;
            box-shadow: var(--shadow-soft);
            max-width: 420px;
            width: 100%;
            margin: 0 auto 2rem;
            min-height: 280px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            transform-style: preserve-3d;
        }

        @media (hover: hover) {
            .timeline-card:hover {
                transform: translateY(-5px);
                box-shadow: 0 8px 30px rgba(255, 133, 162, 0.25);
            }
        }

        .timeline-card h3 {
            font-size: 1.25rem;
            font-weight: 500;
            color: var(--color-accent);
            margin-bottom: 1rem;
        }

        .timeline-card .memory {
            font-size: 1rem;
            color: var(--color-text-dark);
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        .timeline-card .reflection {
            font-size: 1rem;
            color: var(--color-text-light);
            font-family: var(--font-handwritten);
            line-height: 1.6;
            font-weight: 500;
        }

        .timeline-nav {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 1rem;
        }

        .timeline-nav button {
            padding: 12px 32px;
            border: none;
            background: var(--color-primary);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 0.9375rem;
            font-weight: 500;
        }

        .timeline-nav button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .timeline-nav button:active:not(:disabled) {
            transform: scale(0.95);
        }

        .timeline-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .timeline-dots .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-primary);
            opacity: 0.3;
            transition: var(--transition-smooth);
        }

        .timeline-dots .dot.active {
            opacity: 1;
            transform: scale(1.3);
        }

        /* ===================================
           CHAPTER 4: REASONS
        =================================== */
        #chapter-4 {
            justify-content: flex-start;
            padding-top: 60px;
        }

        .reasons-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .reasons-header h2 {
            font-size: 1.75rem;
            font-weight: 300;
            color: var(--color-text-dark);
            margin-bottom: 0.5rem;
        }

        .reasons-header .progress {
            font-size: 0.875rem;
            color: var(--color-text-light);
        }

        .reasons-carousel-container {
            position: relative;
            max-width: 420px;
            width: 100%;
            margin-bottom: 2rem;
        }

        .reasons-carousel {
            overflow: hidden;
            border-radius: 20px;
        }

        .reasons-track {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .reason-card {
            min-width: 100%;
            min-height: 400px;
            perspective: 1000px;
            cursor: pointer;
        }

        .reason-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            min-height: 400px;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        .reason-card.revealed .reason-card-inner {
            transform: rotateY(180deg);
        }

        .reason-card-front,
        .reason-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            min-height: 400px;
            backface-visibility: hidden;
            border-radius: 20px;
            padding: 32px 28px;
            box-shadow: var(--shadow-soft);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .reason-card-front {
            background: white;
            color: var(--color-text-dark);
        }

        .reason-card-back {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            transform: rotateY(180deg);
        }

        .reason-card:active .reason-card-inner {
            transform: scale(0.98);
        }

        .reason-card.revealed:active .reason-card-inner {
            transform: rotateY(180deg) scale(0.98);
        }

        .reason-image {
            width: 100%;
            max-width: 280px;
            height: 200px;
            border-radius: 16px;
            object-fit: cover;
            margin-bottom: 1.5rem;
            animation: photoReveal 0.8s ease forwards;
            animation-delay: 0.3s;
            opacity: 0;
            transform: scale(0.8);
            filter: blur(10px);
        }

        @keyframes photoReveal {
            to {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }

        .reason-number {
            font-size: 0.875rem;
            font-weight: 600;
            opacity: 0.6;
            margin-bottom: 1rem;
            transition: var(--transition-smooth);
        }

        .reason-card.revealed .reason-number {
            opacity: 0.9;
        }

        .reason-placeholder {
            font-size: 1.125rem;
            color: var(--color-text-light);
        }

        .reason-text {
            font-size: 1.0625rem;
            line-height: 1.7;
        }

        .reasons-nav {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .reasons-nav button {
            padding: 12px 32px;
            border: none;
            background: var(--color-primary);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 0.9375rem;
            font-weight: 500;
        }

        .reasons-nav button:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .reasons-nav button:active:not(:disabled) {
            transform: scale(0.95);
        }

        .reasons-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .reasons-dots .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--color-primary);
            opacity: 0.3;
            transition: var(--transition-smooth);
        }

        .reasons-dots .dot.active {
            opacity: 1;
            transform: scale(1.3);
        }

        .reasons-dots .dot.viewed {
            opacity: 0.6;
        }

        .reasons-continue {
            padding: 14px 40px;
            border: none;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition-smooth);
            font-size: 1rem;
            font-weight: 500;
            box-shadow: var(--shadow-soft);
            margin-top: 1.5rem;
            opacity: 0.4;
            pointer-events: none;
        }

        .reasons-continue.enabled {
            opacity: 1;
            pointer-events: all;
        }

        .reasons-continue:active {
            transform: scale(0.95);
        }

        /* ===================================
           CHAPTER 5: THE ASK
        =================================== */
        #chapter-5 {
            background: linear-gradient(135deg, #FFE5EC 0%, #FFF0F5 50%, #FFE5EC 100%);
            background-size: 200% 200%;
            animation: gradientShift 12s ease infinite;
        }

        .ask-content {
            text-align: center;
            width: 100%;
            position: relative;
            z-index: 15;
        }

        .ask-content h2 {
            font-size: 2.75rem;
            font-weight: 300;
            color: var(--color-text-dark);
            margin-bottom: 1rem;
            letter-spacing: -0.02em;
            position: fixed;
            top: 15vh;
            left: 0;
            right: 0;
            z-index: 20;
            pointer-events: none;
            padding: 0 24px;
        }

        .ask-hint {
            font-size: 1rem;
            color: var(--color-text-light);
            font-style: italic;
            opacity: 1;
            transition: opacity 0.4s ease;
            position: fixed;
            top: calc(15vh + 4rem);
            left: 0;
            right: 0;
            z-index: 20;
            pointer-events: none;
        }

        .ask-hint.hidden {
            opacity: 0;
        }

        .button-zone {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 10;
        }

        .button-zone button {
            pointer-events: all;
        }

        .btn-yes, .btn-no {
            position: absolute;
            padding: 16px 40px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.125rem;
            font-weight: 500;
            transition: none;
            transform-origin: center center;
        }

        .btn-yes {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            color: white;
            box-shadow: var(--shadow-soft);
            left: 50%;
            top: 50%;
            margin-left: -90px;
            margin-top: -28px;
            z-index: 11;
            transform-origin: center center;
        }

        .btn-yes:active {
            transform: scale(0.95) !important;
        }

        .btn-no {
            background: white;
            color: var(--color-text-dark);
            border: 2px solid var(--color-primary);
            /* Initial position set by JS */
            z-index: 12;
        }

        /* ===================================
           CHAPTER 6: KEEPSAKE
        =================================== */
        #chapter-6 {
            background: linear-gradient(135deg, var(--color-bg-cream) 0%, var(--color-bg-light) 50%, var(--color-bg-cream) 100%);
            background-size: 200% 200%;
            animation: gradientShift 10s ease infinite;
        }

        .keepsake-card {
            background: white;
            border-radius: 24px;
            padding: 48px 32px;
            box-shadow: 0 10px 40px rgba(255, 133, 162, 0.2);
            max-width: 420px;
            text-align: center;
        }

        .keepsake-card h2 {
            font-size: 2.5rem;
            font-family: var(--font-handwritten);
            font-weight: 600;
            color: var(--color-accent);
            margin-bottom: 1.5rem;
            letter-spacing: 0.02em;
        }

        .keepsake-card .message {
            font-size: 1.125rem;
            color: var(--color-text-dark);
            line-height: 1.7;
            margin-bottom: 2rem;
        }

        .keepsake-card .date {
            font-size: 0.9375rem;
            color: var(--color-text-light);
            font-style: italic;
        }

        .keepsake-decoration {
            margin-top: 2rem;
            font-size: 2rem;
            opacity: 0.3;
        }

        .love-message {
            margin-top: 2rem;
            font-size: 1.75rem;
            font-family: var(--font-handwritten);
            font-weight: 600;
            color: var(--color-accent);
            letter-spacing: 0.5px;
        }

        .signature {
            margin-top: 2.5rem;
            font-size: 1.5rem;
            font-family: var(--font-handwritten);
            font-weight: 600;
            color: var(--color-accent);
            opacity: 0;
        }

        .signature.animated {
            animation: signatureReveal 2s ease forwards;
        }

        @keyframes signatureReveal {
            0% {
                opacity: 0;
                transform: translateY(10px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===================================
           TYPEWRITER EFFECT
        =================================== */
        .typewriter {
            overflow: hidden;
            border-right: 2px solid var(--color-accent);
            white-space: nowrap;
            margin: 0 auto;
            animation: typing 2.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        .typewriter-slow {
            animation: typing 4s steps(40, end), blink-caret 0.75s step-end infinite;
        }

        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }

        @keyframes blink-caret {
            from, to { border-color: transparent; }
            50% { border-color: var(--color-accent); }
        }

        .typewriter.finished {
            border-right: none;
            animation: none;
        }

        /* ===================================
           CONFETTI CANVAS
        =================================== */
        #confetti-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* ===================================
           MUSIC TOGGLE BUTTON
        =================================== */
        .music-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-primary) 100%);
            border: none;
            color: white;
            font-size: 1.25rem;
            cursor: pointer;
            box-shadow: var(--shadow-soft);
            transition: var(--transition-smooth);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .music-toggle:hover {
            transform: scale(1.1);
        }

        .music-toggle:active {
            transform: scale(0.95);
        }

        .music-toggle.muted {
            background: #E5E7EB;
            color: #6B7280;
        }

        /* ===================================
           RESPONSIVE ADJUSTMENTS
        =================================== */
        @media (max-width: 375px) {
            .opening-content h1 {
                font-size: 1.75rem;
            }

            .timeline-card {
                padding: 28px 24px;
                min-height: 260px;
            }

            .ask-content h2 {
                font-size: 2.25rem;
                top: 12vh;
            }
        }

        @media (min-width: 768px) {
            .chapter {
                padding: 48px;
            }
        }
    </style>
</head>
<body>

    <!-- Confetti Canvas -->
    <!-- Loading Screen -->
    <div class="loading-screen" id="loading-screen">
        <div class="loading-heart">üíó</div>
        <p class="loading-text">Something special is loading...</p>
    </div>

    <canvas id="confetti-canvas"></canvas>

    <!-- Music Toggle -->
    <!-- PERSONALIZE: Add your music file path in the JavaScript section below -->
    <button class="music-toggle" id="music-toggle" title="Toggle Music">
        üéµ
    </button>
    <audio id="background-music" loop>
        <!-- PERSONALIZE: Add your music file here -->
        <!-- <source src="path/to/your/music.mp3" type="audio/mpeg"> -->
    </audio>

    <!-- Floating Hearts Background -->
    <div class="floating-hearts">
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
        <div class="heart">‚ô•</div>
    </div>

    <!-- ===================================
         CHAPTER 0: OPENING
    =================================== -->
    <div id="chapter-0" class="chapter active">
        <div class="opening-content">
            <!-- PERSONALIZE: Edit this message -->
            <h1 id="opening-text">I made something for you.</h1>
            <p>Take a moment. This is just for us.</p>
            <button class="btn-begin" onclick="goToChapter(1)">Begin</button>
        </div>
    </div>

    <!-- ===================================
         CHAPTER 1: UNLOCK (Quiz)
    =================================== -->
    <div id="chapter-1" class="chapter">
        <div class="quiz-content" id="quiz-container">
            <h2>Let's see if it's really you...</h2>
            <p class="quiz-progress">Question <span id="quiz-current">1</span> of <span id="quiz-total">3</span></p>

            <div class="quiz-card">
                <p class="quiz-question" id="quiz-question">Loading...</p>
                <div class="quiz-options" id="quiz-options">
                    <!-- Options will be generated here -->
                </div>
            </div>
        </div>

        <!-- Wrong Answer Screen -->
        <div class="wrong-screen" id="wrong-screen">
            <div class="broken-heart">üíî</div>
            <h2>Oops!</h2>
            <p>You're not my Valentine...<br>Bye bye! üëã</p>
        </div>
    </div>

    <!-- ===================================
         CHAPTER 2: TEXT INPUT QUESTION
    =================================== -->
    <div id="chapter-2" class="chapter">
        <div class="text-question-content">
            <!-- PERSONALIZE: Edit the question and answer -->
            <h2>One more thing...</h2>
            <p>Let's see if you remember üí≠</p>

            <div class="text-input-card">
                <p class="text-question">What did we have on our first date?</p>
                <div class="text-input-wrapper">
                    <input
                        type="text"
                        id="text-answer-input"
                        class="text-answer-input"
                        placeholder="Type your answer..."
                        autocomplete="off"
                    >
                </div>
                <button class="text-submit-btn" id="text-submit-btn" onclick="checkTextAnswer()">
                    Submit
                </button>
                <p class="text-feedback" id="text-feedback"></p>
            </div>
        </div>
    </div>

    <!-- ===================================
         CHAPTER 3: TIMELINE (Our Story)
    =================================== -->
    <div id="chapter-3" class="chapter">
        <div class="timeline-header">
            <h2>Our Story</h2>
            <p class="timeline-progress"><span id="timeline-current">1</span> of <span id="timeline-total">5</span></p>
        </div>

        <div class="timeline-card" id="timeline-card">
            <div>
                <h3 id="timeline-title">Loading...</h3>
                <p class="memory" id="timeline-memory"></p>
                <p class="reflection" id="timeline-reflection"></p>
            </div>
        </div>

        <div class="timeline-nav">
            <button onclick="previousMoment()" id="btn-prev">Previous</button>
            <button onclick="nextMoment()" id="btn-next">Next</button>
        </div>

        <div class="timeline-dots" id="timeline-dots"></div>
    </div>

    <!-- ===================================
         CHAPTER 4: REASONS
    =================================== -->
    <div id="chapter-4" class="chapter">
        <div class="reasons-header">
            <h2>Why I love you</h2>
            <p class="progress"><span id="reasons-current">1</span> of <span id="reasons-total">7</span></p>
        </div>

        <div class="reasons-carousel-container">
            <div class="reasons-carousel">
                <div class="reasons-track" id="reasons-track">
                    <!-- Reason cards will be generated here -->
                </div>
            </div>

            <div class="reasons-nav">
                <button onclick="previousReason()" id="btn-reason-prev">Previous</button>
                <button onclick="nextReason()" id="btn-reason-next">Next</button>
            </div>

            <div class="reasons-dots" id="reasons-dots"></div>
        </div>

        <button class="reasons-continue" id="reasons-continue" onclick="goToChapter(5)">Continue</button>
    </div>

    <!-- ===================================
         CHAPTER 5: THE ASK
    =================================== -->
    <div id="chapter-5" class="chapter">
        <div class="ask-content">
            <!-- PERSONALIZE: Edit the question if needed -->
            <h2 id="valentine-question">Will you be my Valentine?</h2>
            <p class="ask-hint" id="ask-hint">No seems shy...</p>

            <div class="button-zone" id="button-zone">
                <button class="btn-yes" id="btn-yes" onclick="handleYes()">Yes</button>
                <button class="btn-no" id="btn-no">No</button>
            </div>
        </div>
    </div>

    <!-- ===================================
         CHAPTER 6: KEEPSAKE
    =================================== -->
    <div id="chapter-6" class="chapter">
        <div class="keepsake-card">
            <!-- PERSONALIZE: Edit name, message, and date -->
            <h2>For Jahnvi</h2>
            <p class="message">
                Thank you for saying yes. This is your keepsake, something to come back to whenever you need a reminder of how much you mean to me.
            </p>
            <p class="date">February 14, 2026</p>
            <div class="keepsake-decoration">‚ô•</div>
            <p class="love-message">Love you ‚ù§</p>
            <!-- PERSONALIZE: Change "Your Name" to your actual name -->
            <p class="signature" id="signature">‚Äî Your Name</p>
        </div>
    </div>

    <!-- ===================================
         JAVASCRIPT
    =================================== -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script>
        // ===================================
        // CHAPTER NAVIGATION
        // ===================================
        let currentChapter = 0;

        function goToChapter(chapterNum) {
            const currentEl = document.getElementById(`chapter-${currentChapter}`);
            const nextEl = document.getElementById(`chapter-${chapterNum}`);

            if (currentEl) {
                currentEl.classList.add('exiting');
                setTimeout(() => {
                    currentEl.classList.remove('active', 'exiting');
                }, 400);
            }

            setTimeout(() => {
                if (nextEl) {
                    nextEl.classList.add('active');
                    currentChapter = chapterNum;
                }
            }, 200);
        }

        // ===================================
        // CHAPTER 1: QUIZ LOGIC
        // ===================================

        /* PERSONALIZE: Replace these with your own personal questions
           Each question should have:
           - question: The question text
           - options: Array of 3-4 answer options
           - correctIndex: Index of the correct answer (0-based)
        */
        const quizQuestions = [
            {
                question: "What's my favorite thing about spending time with you?",
                options: [
                    "When we laugh together",
                    "When we argue",
                    "When we're silent",
                    "When we're apart"
                ],
                correctIndex: 0  // PERSONALIZE: Set the correct answer index
            },
            {
                question: "What was the first thing I noticed about you?",
                options: [
                    "Your shoes",
                    "Your smile",
                    "Your hair",
                    "Your phone"
                ],
                correctIndex: 1  // PERSONALIZE: Set the correct answer index
            },
            {
                question: "What's our special place?",
                options: [
                    "The park",
                    "The coffee shop",
                    "The library",
                    "The mall"
                ],
                correctIndex: 1  // PERSONALIZE: Set the correct answer index
            }
        ];

        let currentQuizIndex = 0;
        let quizLocked = false;

        function renderQuiz() {
            const question = quizQuestions[currentQuizIndex];
            document.getElementById('quiz-question').textContent = question.question;
            document.getElementById('quiz-current').textContent = currentQuizIndex + 1;
            document.getElementById('quiz-total').textContent = quizQuestions.length;

            const optionsContainer = document.getElementById('quiz-options');
            optionsContainer.innerHTML = '';

            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'quiz-option';
                button.textContent = option;
                button.onclick = () => selectAnswer(index);
                optionsContainer.appendChild(button);
            });

            quizLocked = false;
        }

        function selectAnswer(selectedIndex) {
            if (quizLocked) return;
            quizLocked = true;

            const question = quizQuestions[currentQuizIndex];
            const options = document.querySelectorAll('.quiz-option');
            const selectedOption = options[selectedIndex];

            if (selectedIndex === question.correctIndex) {
                // Correct answer
                selectedOption.classList.add('correct');

                setTimeout(() => {
                    if (currentQuizIndex < quizQuestions.length - 1) {
                        // Next question
                        currentQuizIndex++;
                        renderQuiz();
                    } else {
                        // Quiz complete! Move to next chapter
                        setTimeout(() => {
                            goToChapter(2);
                        }, 500);
                    }
                }, 1000);
            } else {
                // Wrong answer - show "bye bye" screen
                selectedOption.classList.add('wrong');

                setTimeout(() => {
                    document.getElementById('quiz-container').style.display = 'none';
                    document.getElementById('wrong-screen').classList.add('active');
                }, 800);
            }
        }

        function initQuiz() {
            renderQuiz();
        }

        // ===================================
        // CHAPTER 2: TEXT INPUT QUESTION LOGIC
        // ===================================

        /* PERSONALIZE: Set the correct answer here */
        const TEXT_ANSWER = "pizza"; // The correct answer (case-insensitive)

        function checkTextAnswer() {
            const input = document.getElementById('text-answer-input');
            const feedback = document.getElementById('text-feedback');
            const submitBtn = document.getElementById('text-submit-btn');
            const userAnswer = input.value.trim().toLowerCase();

            if (!userAnswer) {
                feedback.textContent = "Please type an answer!";
                feedback.className = 'text-feedback wrong';
                return;
            }

            if (userAnswer === TEXT_ANSWER.toLowerCase()) {
                // Correct!
                feedback.textContent = "That's right! üéâ";
                feedback.className = 'text-feedback correct';
                input.disabled = true;
                submitBtn.disabled = true;

                setTimeout(() => {
                    goToChapter(3);
                }, 1500);
            } else {
                // Wrong answer
                feedback.textContent = "Hmm, not quite... Try again! üí≠";
                feedback.className = 'text-feedback wrong';
                input.value = '';
                input.focus();
            }
        }

        // Allow Enter key to submit
        document.addEventListener('DOMContentLoaded', () => {
            const input = document.getElementById('text-answer-input');
            if (input) {
                input.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        checkTextAnswer();
                    }
                });
            }
        });

        // ===================================
        // CHAPTER 3: TIMELINE DATA & LOGIC
        // ===================================

        /* PERSONALIZE: Replace this array with your actual memories
           Each moment should have:
           - title: Short moment name (e.g., "First Coffee")
           - memory: One-sentence description of what happened
           - reflection: One-sentence emotional note about that moment
        */
        const timelineMoments = [
            {
                title: "The Pink Dress",
                memory: "I saw you on the stairs of your home in Texas, and believe me, I was already in love with the pink dress that you wore and you.",
                reflection: "It felt like it was made to be."
            },
            {
                title: "Pizza & Everywhere",
                memory: "We spent time in pizza shops and in clubs and on mountaintops.",
                reflection: "Everywhere that I was with you, I had the best time."
            },
            {
                title: "The Flights",
                memory: "I flew to Mississippi and you flew to California.",
                reflection: "And then we flew into each other's hearts."
            },
            {
                title: "What Defines Us",
                memory: "We had our ups and downs, but I guess that is what defines us.",
                reflection: "I love you more than anything that I've ever loved."
            },
            {
                title: "Forever",
                memory: "I miss you even if I just saw you. I can't think of anything until I think if Janvi would like it.",
                reflection: "I can't wait to make you my forever."
            }
        ];

        let currentMoment = 0;

        function renderMoment() {
            const moment = timelineMoments[currentMoment];
            document.getElementById('timeline-title').textContent = moment.title;
            document.getElementById('timeline-memory').textContent = moment.memory;
            document.getElementById('timeline-reflection').textContent = moment.reflection;
            document.getElementById('timeline-current').textContent = currentMoment + 1;
            document.getElementById('timeline-total').textContent = timelineMoments.length;

            // Update navigation buttons
            document.getElementById('btn-prev').disabled = currentMoment === 0;
            document.getElementById('btn-next').textContent =
                currentMoment === timelineMoments.length - 1 ? 'Continue' : 'Next';

            // Update dots
            const dots = document.querySelectorAll('.timeline-dots .dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentMoment);
            });
        }

        function nextMoment() {
            if (currentMoment < timelineMoments.length - 1) {
                currentMoment++;
                renderMoment();
            } else {
                goToChapter(4);
            }
        }

        function previousMoment() {
            if (currentMoment > 0) {
                currentMoment--;
                renderMoment();
            }
        }

        function initTimeline() {
            // Create dots
            const dotsContainer = document.getElementById('timeline-dots');
            timelineMoments.forEach((_, index) => {
                const dot = document.createElement('div');
                dot.className = 'dot';
                if (index === 0) dot.classList.add('active');
                dotsContainer.appendChild(dot);
            });

            renderMoment();
        }

        // ===================================
        // CHAPTER 4: REASONS DATA & LOGIC
        // ===================================

        /* PERSONALIZE: Replace this array with your actual reasons
           Keep it to 7-10 reasons maximum
           Write these in YOUR voice, not poetic language
           Optional: Add image URL for each reason (or leave as null)
        */
        const reasons = [
            {
                text: "You love taking care of other people.",
                image: null  // PERSONALIZE: Add image URL here if desired, e.g., "path/to/photo.jpg"
            },
            {
                text: "I love you more than anything that I've ever loved.",
                image: null
            },
            {
                text: "I miss you even if I just saw you.",
                image: null
            },
            {
                text: "I can't think of anything until I think if Janvi would like it or not.",
                image: null
            },
            {
                text: "First thing in the morning I wake up and I think of texting my baby.",
                image: null
            },
            {
                text: "We had our ups and downs, but that's what defines us.",
                image: null
            },
            {
                text: "Everywhere that I was with you, I had the best time.",
                image: null
            }
        ];

        let currentReason = 0;
        const viewedReasons = new Set();

        function initReasons() {
            const track = document.getElementById('reasons-track');
            const dotsContainer = document.getElementById('reasons-dots');
            track.innerHTML = '';
            dotsContainer.innerHTML = '';

            reasons.forEach((reason, index) => {
                // Create card
                const card = document.createElement('div');
                card.className = 'reason-card';
                card.innerHTML = `
                    <div class="reason-card-inner">
                        <div class="reason-card-front">
                            <div class="reason-number">Reason ${index + 1}</div>
                            <div class="reason-placeholder">Tap to reveal</div>
                        </div>
                        <div class="reason-card-back">
                            ${reason.image ? `<img src="${reason.image}" class="reason-image" alt="Memory ${index + 1}">` : ''}
                            <div class="reason-text">${reason.text}</div>
                        </div>
                    </div>
                `;
                card.onclick = () => revealReason(index);
                track.appendChild(card);

                // Create dot
                const dot = document.createElement('div');
                dot.className = 'dot';
                if (index === 0) dot.classList.add('active');
                dotsContainer.appendChild(dot);
            });

            document.getElementById('reasons-total').textContent = reasons.length;
            updateReasonsNavigation();
        }

        function updateReasonsNavigation() {
            const track = document.getElementById('reasons-track');
            track.style.transform = `translateX(-${currentReason * 100}%)`;

            document.getElementById('reasons-current').textContent = currentReason + 1;
            document.getElementById('btn-reason-prev').disabled = currentReason === 0;
            document.getElementById('btn-reason-next').disabled = currentReason === reasons.length - 1;

            // Update dots
            const dots = document.querySelectorAll('.reasons-dots .dot');
            dots.forEach((dot, index) => {
                dot.classList.toggle('active', index === currentReason);
                dot.classList.toggle('viewed', viewedReasons.has(index));
            });

            // Check if all reasons have been viewed
            if (viewedReasons.size === reasons.length) {
                document.getElementById('reasons-continue').classList.add('enabled');
            }
        }

        function nextReason() {
            if (currentReason < reasons.length - 1) {
                currentReason++;
                updateReasonsNavigation();
            }
        }

        function previousReason() {
            if (currentReason > 0) {
                currentReason--;
                updateReasonsNavigation();
            }
        }

        function revealReason(index) {
            const cards = document.querySelectorAll('.reason-card');
            const card = cards[index];

            if (!card.classList.contains('revealed')) {
                card.classList.add('revealed');
                viewedReasons.add(index);
                updateReasonsNavigation();
            }
        }

        // ===================================
        // CHAPTER 5: YES/NO LOGIC
        // ===================================
        let yesScale = 1;
        let noButtonInitialized = false;
        const DETECTION_THRESHOLD = 150; // pixels
        const ESCAPE_DISTANCE = 200; // pixels
        const EDGE_MARGIN = 20; // margin from viewport edges

        function initNoButton() {
            if (noButtonInitialized) return;

            const yesBtn = document.getElementById('btn-yes');
            const noBtn = document.getElementById('btn-no');

            // Wait for layout
            requestAnimationFrame(() => {
                // Position No button to the right of center in viewport
                const viewportWidth = window.innerWidth;
                const viewportHeight = window.innerHeight;

                const initialLeft = (viewportWidth / 2) + 120;
                const initialTop = (viewportHeight / 2) - 28; // Half button height

                noBtn.style.left = initialLeft + 'px';
                noBtn.style.top = initialTop + 'px';
                noBtn.style.transform = 'none';

                noButtonInitialized = true;
            });

            // Add pointer event listeners to document for full coverage
            const handlePointerMove = (e) => {
                const noBtn = document.getElementById('btn-no');
                const yesBtn = document.getElementById('btn-yes');
                if (!noBtn || !yesBtn) return;

                const noRect = noBtn.getBoundingClientRect();

                // Get pointer position
                const pointerX = e.clientX || (e.touches && e.touches[0].clientX);
                const pointerY = e.clientY || (e.touches && e.touches[0].clientY);

                if (!pointerX || !pointerY) return;

                // Calculate No button center
                const noCenterX = noRect.left + noRect.width / 2;
                const noCenterY = noRect.top + noRect.height / 2;

                // Calculate distance from pointer to No button center
                const deltaX = noCenterX - pointerX;
                const deltaY = noCenterY - pointerY;
                const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);

                // If pointer is too close, move No button away
                if (distance < DETECTION_THRESHOLD) {
                    // Normalize direction vector
                    const dirX = deltaX / distance;
                    const dirY = deltaY / distance;

                    // Calculate new position (move away from pointer)
                    const currentLeft = parseFloat(noBtn.style.left) || 0;
                    const currentTop = parseFloat(noBtn.style.top) || 0;

                    let newLeft = currentLeft + (dirX * ESCAPE_DISTANCE);
                    let newTop = currentTop + (dirY * ESCAPE_DISTANCE);

                    // Clamp within viewport bounds with margin
                    const viewportWidth = window.innerWidth;
                    const viewportHeight = window.innerHeight;
                    const maxLeft = viewportWidth - noRect.width - EDGE_MARGIN;
                    const maxTop = viewportHeight - noRect.height - EDGE_MARGIN;

                    newLeft = Math.max(EDGE_MARGIN, Math.min(newLeft, maxLeft));
                    newTop = Math.max(EDGE_MARGIN, Math.min(newTop, maxTop));

                    // Apply new position
                    noBtn.style.left = newLeft + 'px';
                    noBtn.style.top = newTop + 'px';

                    // Grow Yes button
                    yesScale = Math.min(yesScale + 0.08, 2.0);
                    yesBtn.style.transform = `scale(${yesScale})`;
                }
            };

            // Mouse events on document
            document.addEventListener('pointermove', handlePointerMove);
            document.addEventListener('mousemove', handlePointerMove);

            // Touch events (fallback)
            document.addEventListener('touchmove', handlePointerMove, { passive: true });

            // Prevent No button click
            noBtn.addEventListener('click', (e) => {
                e.preventDefault();
                e.stopPropagation();
            });
        }

        function handleYes() {
            // Hide hint
            const hint = document.getElementById('ask-hint');
            if (hint) hint.classList.add('hidden');

            // Trigger confetti
            const duration = 3000;
            const end = Date.now() + duration;

            (function frame() {
                confetti({
                    particleCount: 3,
                    angle: 60,
                    spread: 55,
                    origin: { x: 0 },
                    colors: ['#FFB6C1', '#FFC8DD', '#FF85A2']
                });
                confetti({
                    particleCount: 3,
                    angle: 120,
                    spread: 55,
                    origin: { x: 1 },
                    colors: ['#FFB6C1', '#FFC8DD', '#FF85A2']
                });

                if (Date.now() < end) {
                    requestAnimationFrame(frame);
                }
            }());

            setTimeout(() => {
                goToChapter(6);
            }, 1500);
        }

        // Initialize No button when Chapter 5 becomes active
        const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
                if (mutation.target.id === 'chapter-5' && mutation.target.classList.contains('active')) {
                    setTimeout(initNoButton, 100);
                }
            });
        });

        window.addEventListener('DOMContentLoaded', () => {
            const chapter5 = document.getElementById('chapter-5');
            if (chapter5) {
                observer.observe(chapter5, {
                    attributes: true,
                    attributeFilter: ['class']
                });
            }
        });

        // ===================================
        // INITIALIZATION

        // ===================================
        // LOADING SCREEN
        // ===================================
        function hideLoadingScreen() {
            const loadingScreen = document.getElementById('loading-screen');
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
            }, 2000);
        }

        // ===================================
        // TYPEWRITER EFFECT
        // ===================================
        function typewriterEffect(elementId, text, speed = 50) {
            const element = document.getElementById(elementId);
            if (!element) return;

            element.textContent = '';
            element.style.display = 'inline-block';
            let i = 0;

            function type() {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                } else {
                    setTimeout(() => {
                        element.style.borderRight = 'none';
                    }, 1000);
                }
            }

            element.style.borderRight = '2px solid var(--color-accent)';
            element.style.paddingRight = '5px';
            type();
        }

        // ===================================
        // MUSIC TOGGLE
        // ===================================
        let musicPlaying = false;

        function initMusicToggle() {
            const musicToggle = document.getElementById('music-toggle');
            const backgroundMusic = document.getElementById('background-music');

            if (musicToggle && backgroundMusic) {
                musicToggle.addEventListener('click', () => {
                    if (musicPlaying) {
                        backgroundMusic.pause();
                        musicToggle.textContent = 'üîá';
                        musicToggle.classList.add('muted');
                        musicPlaying = false;
                    } else {
                        backgroundMusic.play().catch(e => {
                            console.log('Music playback failed:', e);
                        });
                        musicToggle.textContent = 'üéµ';
                        musicToggle.classList.remove('muted');
                        musicPlaying = true;
                    }
                });
            }
        }

        // ===================================
        // ANIMATED SIGNATURE
        // ===================================
        function revealSignature() {
            const signature = document.getElementById('signature');
            if (signature) {
                setTimeout(() => {
                    signature.classList.add('animated');
                }, 1000);
            }
        }

        // Store original goToChapter function
        let originalGoToChapter = goToChapter;

        // Override goToChapter with enhanced version
        goToChapter = function(chapterNum) {
            setTimeout(() => {
                if (chapterNum === 5) {
                    const questionElement = document.getElementById('valentine-question');
                    if (questionElement) {
                        const text = questionElement.textContent;
                        typewriterEffect('valentine-question', text, 80);
                    }
                } else if (chapterNum === 6) {
                    revealSignature();
                }
            }, 400);

            originalGoToChapter(chapterNum);
        };
        // ===================================
        // INITIALIZATION
        // ===================================
        window.addEventListener('DOMContentLoaded', () => {
            // Hide loading screen
            hideLoadingScreen();

            // Initialize music toggle
            initMusicToggle();

            // Initialize chapters
            initQuiz();
            initTimeline();
            initReasons();

            // Typewriter effect on opening
            setTimeout(() => {
                const openingText = document.getElementById('opening-text');
                if (openingText) {
                    const text = openingText.textContent;
                    typewriterEffect('opening-text', text, 60);
                }
            }, 2200); // After loading screen fades
        });
    </script>

</body>
</html>